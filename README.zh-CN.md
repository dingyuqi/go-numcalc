# go_numcalc

**其他语言版本: [English](./README.md)**

go_numcalc 包是一个Go语言开发的包. 主要功能为针对数值类型的数据进行数据转换, 数据分组, 数据平滑等基础的数值处理.
所有功能均仅支持两种数据类型: Int32和Float32.

> [!TIP]
> 该包是用Go语言编写的，含有部分C++, 即cgo部分

<!-- TOC -->

* [go_numcalc](#go_numcalc)
    * [安装](#安装)
    * [依赖](#依赖)
    * [用法](#用法)
    * [项目结构](#项目结构)
    * [开发](#开发)
        * [一期功能](#一期功能)
        * [二期功能(TODO)](#二期功能todo)
    * [认证](#认证)

<!-- TOC -->

## 安装

使用 `go get`安装

```shell
go get -u git@github.com/dingyuqi/go_numcalc.git
```

## 依赖

NumCalc 包中主要使用两个外部库:

1. Go语言: [Gonum](https://www.gonum.org/)
2. C++语言: [Armadillo](https://arma.sourceforge.net/docs.html#top)

其中Armadillo无需安装, 以静态库形式在Cgo中调用.

## 用法

下面是一个关于conversion中`LogInt32()`方法简单的例子, 其他的函数使用方法与该Demo一致.

1. 调用conversion中的`NewCalculator()`方法来初始化一个数值转换的对象.
2. 调用`LogInt32()`方法. 该方法将返回切片`data`对应下标的对数计算结果.

```go
package main

import (
	"github.com/dingyuqi/go_numcalc/src/conversion"
	"log"
)

func main() {
	data := []int32{1, 2, 3, 4, 5}
	c, err := conversion.NewCalculator()
	result, err := c.LogInt32(data)
	if err != nil {
		log.Fatal(err)
		return
	}
	log.Println("计算结果为: ", result)
}

```

> [!TIP]
> 该测试代码在 `example/example_test.go` 中, 可以直接运行.

## 项目结构

1. **src**: 用于放置Go语言源码
    - binning: 数据分组
    - conversion: 数据转换
    - outlier: 离群值判断
    - smoothness: 数据平滑
2. **pkg**: 用于放置C++语言Armadillo库的静态编译文件以及相关头文件.
3. **example**: 用于放置Cgo调用样例和Go语言调用样例.
4. **test**: 单元测试数据以及测试用例.

> [!TIP]
> 如果想测试Cgo可直接在example文件夹下执行以下命令:
>   ```shell
>    go build ./example.exe
>   ```
> `example_test.go`中为同样功能(对数计算)的纯Go语言实现, 用于对比Cgo的计算速度.

## 开发

截至2023年8月, 仅实现一期功能, 实现语言全部基于Go语言.

### 一期功能

| 序号 | 类型    | 功能         | 功能详细描述                                                                     | 备注                                                 |
|----|-------|------------|----------------------------------------------------------------------------|----------------------------------------------------|
| 1  | 数据转换  | 最小最大标准化    | 对数据系列作线性变换，使得处理过后数据均落在［0，1］区间内                                             |                                                    |
| 2  | 数据转换  | Z-score标准化 | 对数据系列中的每一个数据点作减去均值并除以方差的操作，使得处理后的数据近似符合(0,1) 的标准正态分布                       |                                                    |
| 3  | 数据转换  | 对数转换       | $y = \log_{base}{x}$                                                       | 1. 负值处理    </br> 2. base值                          |
| 4  | 数据转换  | 平方根转换      | $y = \sqrt{x}$                                                             | 负值处理                                               |
| 5  | 数据分组  | 聚类分组       | 使用聚类分析方法将数据点分组为具有相似特征的簇。通过聚类分组，可以发现数据中的聚集模式和类别，对于数据挖掘和分类任务有用。              | 1. 聚类方法(random_subset,static_subset等)</br>2. 聚类的个数 |                                        |
| 6  | 数据分组  | 等宽分组       | 将数据的取值范围划分为相等宽度的区间。这种方法简单直观，但可能无法很好地反映数据的分布特征，特别是在存在数据不平衡或异常值的情况下。         | 分组宽度                                               |
| 7  | 数据分组  | 等频分组       | 将数据划分为每个组包含相同数量的数据点。这种方法可以更好地考虑数据的分布特征，但对于包含大量重复值的数据，可能会导致一些组具有相同的取值。      | 分组数量                                               |
| 8  | 数据分组  | 基于统计量的分组   | 根据数据的分位数将数据划分为组。常见的方法包括四分位数分组、十分位数分组等。这种方法可以将数据分为具有相同数据密度的组，对于偏斜分布的数据较为有效。 | 分组条件 _(由于与等频分组功能重合, 暂时不实现)_                        |
| 9  | 离群值判断 | 标准差        | 通过计算数据点与平均值的标准差之间的差异，将超出一定阈值的值视为离群值，通常将超过3倍标准差的值视为离群值                      | 1. true表示离群值</br>2. false表示非离群值  </br> 3. 离群判断的阈值  |
| 10 | 离群值判断 | 箱线图        | 根据数据的四分位数和异常值范围，将超出上下边界的值视为离群值。                                            | 1. true表示离群值</br>2. false表示非离群值                    |

### 二期功能(TODO)

| 序号 | 类型   | 功能               | 功能详细描述                                                                                                                         | 备注                                                                                                                                                                                                                                                |
|----|------|------------------|--------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1  | 数据平滑 | 小波过滤             | 通过应用小波变换（Wavelet Transform）对信号进行分解和重构，以去除噪声或突变，并保留信号中的重要特征。小波过滤在时域和频域上都能提供较好的分析和处理能力。                                          | 不同的基波函数对结果影响较大, 不同的数据需要根据分析需求选择不同的基波函数以及频率范围. </br>  1.小波基函数(Daubechies小波、Haar小波、Morlet小波)</br>2.尺度参数(决定了小波变换中每个小波基函数的缩放倍数;较小的尺度参数可以捕捉更高频率和细节的信号特征，而较大的尺度参数可以捕捉较低频率和整体趋势的信号特征)</br>3.分解层数(确定了小波变换的级数;较高的分解层数可以提供更详细的频率和尺度信息)</br>4. 阈值处理方法(保留/丢弃) |
| 2  | 数据平滑 | 移动平均             | 该方法通过计算数据点周围一定窗口大小内的平均值来平滑数据。窗口大小决定了平滑程度，较大的窗口将平滑更多的波动。常见的移动平均包括简单移动平均（Simple Moving Average）和加权移动平均（Weighted Moving Average）。 | 如果边界无法完全构建一个满足窗口大小的窗口,通常会在输出结果中去除这些边界处的数据点导致不等长. 1.窗口大小 </br>2. 权重 </br>边界处理方法                                                                                                                                                                    |
| 3  | 数据平滑 | 指数平滑             | 指数平滑是一种递归平滑方法，赋予近期数据较高的权重。通过指定平滑系数来控制过去观测值的权重，其中平滑系数越大，对近期数据的影响越大。指数平滑方法常用于时间序列数据的平滑。                                          | 平滑因子                                                                                                                                                                                                                                              |
| 4  | 数据平滑 | Savitzky-Golay平滑 | 这是一种基于多项式拟合的平滑方法，通过将数据点周围的邻近数据拟合到一个多项式曲线来平滑数据。Savitzky-Golay平滑方法可以保留数据的整体形状和趋势，对噪声的抑制效果较好。                                     | 1.平滑窗口 </br>2. 多项式阶数 </br> 3. 导数阶数(可选)                                                                                                                                                                                                            |
| 5  | 数据平滑 | Loess平滑          | 类似于 Lowess平滑，Loess平滑也是一种非参数的局部回归方法。它通过在数据点周围的邻近数据上进行多项式拟合来平滑数据。与 Lowess平滑不同的是，Loess平滑使用了自适应的加权最小二乘法，以更好地处理数据中的非线性关系。           | 1.平滑系数(控制了对过去观测值的权重)  </br>2. 加权函数(库里面有默认的)                                                                                                                                                                                                       |                                        |
| 6  | 数据平滑 | Lowess平滑         | Lowess平滑是一种非参数的局部回归方法，通过拟合局部线性回归模型来平滑数据。该方法使用加权最小二乘法来估计数据点的平滑值，权重根据距离数据点的远近进行分配。                                               | 1.平滑系数(控制了对过去观测值的权重)  </br>2. 加权函数(库里面有默认的)                                                                                                                                                                                                       |

## 认证

[MIT](https://choosealicense.com/licenses/mit/) License